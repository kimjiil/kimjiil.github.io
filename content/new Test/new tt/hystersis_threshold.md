---
imageNameKey: 2024-08-23-13-19
tags:
  - halcon_function
---
**설명**  
hysteresis_threshold는 이미지에 대해 히스테리시스 임계값 연산(Canny가 도입)을 수행합니다. 입력 이미지에서 Gray 값이 High 이상인 모든 포인트는 즉시 받아들여집니다(“확실한” 포인트). 반대로, Gray 값이 Low보다 작은 모든 포인트는 즉시 거부됩니다. Low와 High 사이의 Gray 값을 가지는 “잠재적” 포인트는 “확실한” 포인트와 잠재적 포인트 경로(MaxLength 포인트 길이까지)를 통해 연결된 경우 받아들여집니다. 이는 “확실한” 포인트가 그 주변에 영향을 미친다는 것을 의미합니다(히스테리시스).

**주의 사항**  
이미지 타입이 byte, uint2, 또는 int4인 경우, 낮은 임계값은 Low > 0이어야 합니다.

**실행 정보**

- 다중 스레드 유형: 재진입 가능 (독점적이지 않은 연산과 병렬로 실행).
- 다중 스레드 범위: 글로벌 (어떤 스레드에서든 호출 가능).
- 자동 병렬화: 튜플 레벨에서 자동 병렬화.
- 자동 병렬화: 내부 데이터 레벨에서 자동 병렬화.

**매개 변수**

- **Image (input_object):** 단일 채널 이미지(-array) → 객체 (byte / uint2 / int4 / real)  
    입력 이미지.
    
- **RegionHysteresis (output_object):** 영역(-array) → 객체  
    세그먼트화된 영역.
    
- **Low (input_control):** 숫자 → (정수 / 실수)  
    Gray 값에 대한 하한 임계값.
    
    - 기본값: 30
    - 제안된 값: 5, 10, 15, 20, 30, 40, 50, 60, 70, 80, 90, 100
- **High (input_control):** 숫자 → (정수 / 실수)  
    Gray 값에 대한 상한 임계값.
    
    - 기본값: 60
    - 제안된 값: 5, 10, 15, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130
    - 제한: High ≥ Low
- **MaxLength (input_control):** 정수 → (정수)  
    "확실한" 포인트에 도달하기 위한 "잠재적" 포인트의 최대 경로 길이.
    
    - 기본값: 10
    - 제안된 값: 1, 2, 3, 5, 7, 10, 12, 14, 17, 20, 25, 30, 35, 40, 50
    - 값의 일반적인 범위: 1 ≤ MaxLength
    - 최소 증가량: 1
    - 권장 증가량: 5
    - 제한: MaxLength > 1
### 요약:

`hysteresis_threshold`는 Canny의 히스테리시스 임계값 연산을 수행하여 이미지를 이진화하는 연산입니다. 이미지의 픽셀 값을 기준으로 낮은 임계값 이하의 픽셀은 거부하고, 높은 임계값 이상의 픽셀은 수용합니다. 중간 임계값의 픽셀은 높은 임계값의 픽셀과 연결된 경우만 수용되며, 그 연결 길이는 `MaxLength`로 제한됩니다. 이 연산은 노이즈를 줄이고 경계선을 보다 명확하게 식별하는 데 유용합니다.

### 예제 이미지

가로 5x5 픽셀의 작은 그레이스케일 이미지가 있다고 가정해 보겠습니다. 각 픽셀의 그레이 값은 다음과 같습니다:


```
70  80  90  70  50 
60  95 100  85  55 
50  90 120  90  50 
55  85 100  95  60 
60  70  80  75  65
```

### 1. **임계값 설정**

- **Low (낮은 임계값)**: 60
- **High (높은 임계값)**: 90
- **MaxLength (최대 길이)**: 3

### 2. **알고리즘 단계**

#### **1단계: "확실한" 포인트 식별 (High 임계값 이상)**

- 각 픽셀에서 그레이 값이 High(90)보다 크거나 같은 포인트는 "확실한" 포인트로 설정됩니다.
    
```
0   0   1   0   0 
0   1   1   0   0 
0   1   1   1   0 
0   0   1   1   0 
0   0   0   0   0
```
    
여기서 1은 "확실한" 포인트를 의미합니다.
    

#### **2단계: "잠재적" 포인트 식별 (Low와 High 사이)**

- Low(60)와 High(90) 사이에 있는 그레이 값을 가진 픽셀은 "잠재적" 포인트로 간주됩니다. 이 포인트들은 "확실한" 포인트와 연결되어 있을 때만 최종적으로 받아들여집니다. 연결은 MaxLength(3) 이내로 가능합니다.
    
```
x   x   1   x   0 
x   1   1   x   0
0   1   1   1   0 
0   x   1   1   x 
x   x   x   x   x
```
    
여기서 x는 아직 결정되지 않은 "잠재적" 포인트를 의미합니다.
    
#### **3단계: "잠재적" 포인트 연결 확인**

- 이제 "잠재적" 포인트들이 "확실한" 포인트와 연결되어 있는지 확인합니다. 이 예제에서는 `MaxLength`가 3이기 때문에,  "잠재적" 포인트가 "확실한" 포인트와 의 거리가 MaxLength 내에 있으면 받아 들여진다.
- 에를 들어 (0, 0)의 잠재적 포인트는 (1, 1)의 확실한 포인트와의 거리가 1 이므로 받아 들여진다. 이때 거리는 8 neigbor방향으로 움직여 1칸으로 도달할 수 있으면 된다.
- 아래 그림에서 asterisk(\*)와 거리가 2 내에 있는 픽셀 들을 표시

```
0  0  0  0  0  0  0
0  2  2  2  2  2  0
0  2  1  1  1  2  0
0  2  1  *  1  2  0
0  2  1  1  1  2  0
0  2  2  2  2  2  0
0  0  0  0  0  0  0
```
#### **4단계: 결과 이미지**

- 최종적으로 받아 들여진 포인트만 남깁니다.
    
```
2   2   1   2   0 
2   1   1   2   0
0   1   1   1   0 
0   2   1   1   2 
2   2   2   2   2
```

여기서 최종적으로 1, 2로 표시된 포인트들은 경계로 식별된 포인트들입니다. 이는 이미지에서 중요한 경계나 객체의 윤곽을 나타내는 부분으로, 이미지 처리 및 분석에서 중요한 역할을 합니다.

### 요약
- **High 임계값**: "확실한" 경계 포인트로 즉시 수용.
- **Low 임계값**: 경계로 고려될 수 있지만, "확실한" 포인트에 연결되어야 수용.
- **MaxLength**: "확실한" 포인트와 연결된 "잠재적" 포인트의 최대 길이.

이 과정을 통해 이미지에서 중요한 경계선이 추출되고, 노이즈를 제거하여 더 명확한 이미지 분석이 가능해집니다.